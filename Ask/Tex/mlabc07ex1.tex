\documentclass[a4paper,10pt]{article} \usepackage{anysize}
\marginsize{2cm}{2cm}{1cm}{1cm}
%\textwidth 6.0in \textheight = 664pt
\usepackage{xltxtra}
\usepackage{xunicode} \usepackage{graphicx}
\usepackage{color} \usepackage{xgreek} \usepackage{fancyvrb}
\usepackage{minted}
\usepackage{listings}
\usepackage{enumitem} \usepackage{framed} \usepackage{relsize}
\usepackage{float} \setmainfont[Mapping=TeX-text]{DejaVu Sans}
\begin{document}

\include{title/title}

\section*{} \setcounter{section}{1}
\subsection*{Άσκηση 1(ii)}\setcounter{subsection}{1}
Σ' αυτή την άσκηση κατασκευάζουμε ένα χρονόμετρο δευτερολέπτων που μετράει
από το $0_{10}$ έως το $15_{10}$ και στη συνέχεια ξαναρχίζει απ' την αρχή. Γι' αυτό το λόγο
έχουμε στον καταχωρητή Α το μετρητή, που λόγω της αρνητικής λογικής των led
αρχικοποιούμε στο $FF_{16}$ και στη συνέχεια αφαιρούμε $1$, μέχρι το $F0_{16}
(=15_{10})$. Στην αρχή καλούμε τη ρουτίνα \textbf{BEEP} ενώ για την χρονοκαθυστέρηση
του ενός δευτερολέπτου φορτώνουμε στο διπλό καταχωρητή B-C το $1000_{10}
(=03Ε8_{16})$,
που η ρουτίνα \textbf{DELB} πολλαπλασιάζει επί $1 msec$, άρα συνολική
καθυστέρηση $1 sec$.
Οι ρουτίνες αυτές επηρεάζουν τους καταχωρητές του συστήματος· συγκεκριμένα η
ρουτίνα \textbf{DELB} εσωτερικά αποθηκεύει στη στοίβα όλους τους καταχωρητές και τον
καταχωρητή σημαιών, επομένως δε χρειάζεται να τους αποθηκεύσουμε εμείς πριν
την καλέσουμε ενώ για τη ρουτίνα \textbf{BEEP} δε χρειάζεται να τους αποθηκεύσουμε
δεδομένου ότι στην αρχή του προγράμματος τους αρχικοποιούμε κάθε φορά.
\inputminted[linenos,obeytabs,fontsize=\footnotesize]{oldasm}{../askhsh_1_ii.8085}
\subsection*{Άσκηση 2(i)}
Εδώ ζητείται να ανάβουμε και να σβήνουμε τα led ανάλογα με την τιμή των
τεσσάρων  αριστερότερων και δεξιότερων διακοπτών της πόρτας $2000_{16}$ αντίστοιχα,
με καθυστέρηση $200$ έως $1700 msec$ και βήμα $100 msec$. Γι' αυτό το λόγο, αφού σε
κάθε συνδυασμό 4 διακοπτών έχουμε 16 δυνατές εισόδους με βήμα $+100msec$ κάθε
φορά, χρησιμοποιήσαμε τη συνάρτηση: $100 * x + 200$, όπου $x$ o δεκαδικός αριθμός
που διαβάζουμε από τα τέσσερα MSB και LSB των διακοπτών αντίστοιχα. Έτσι,
διαβάζουμε την είσοδο και αφού τα χωρίσουμε σε MSB και LSB, στη συνέχεια
πολλαπλασιάζουμε το διπλό καταχωρητή B-C επί $100$ με κατάλληλες διαδοχικές
ολισθήσεις και προσθέσεις $(100= 2^2 + 2^5 + 2^6)$ και τέλος προσθέτουμε
$200_{10} (=00C8_{16})$.
\inputminted[linenos,obeytabs,fontsize=\footnotesize]{oldasm}{../askhsh_2_i.8085}
\subsection*{Άσκηση 2(ii) α}
Σ' αυτή την άσκηση ζητείται να υλοποιήσουμε ένα χρονόμετρο δευτερολέπτων
που θα τρέχει με ταχύτητα μίας μέτρησης ανά δέκατο του δευτερολέπτου και θα
απεικονίζεται στα τέσσερα LSB των led στην πόρτα εξόδου $3000H$ ενώ στα τέσσερα
MSB θα απεικονίζεται ο αριθμός των διακοπών. Για τη ζητούμενη χρονοκαθυστέρηση
φορτώνουμε στο διπλό  καταχωρητή B-C το $100_{10} (=0064_{16})$. Έπειτα, αφού
ελέγξουμε περιοδικά το MSB της θύρας εισόδου $2000_{16}$  ότι είναι ΟΝ,
ενεργοποιούμε τις διακοπές RST6.5 φορτώνοντας στον καταχωρητή Α την τιμή
$0D_{16}$
που θα γίνει η μάσκα των διακοπών. Για τη ρουτίνα εξυπηρέτησης της διακοπής
έχουμε υλοποιήσει το δεύτερο διάγραμμα ροής, όπου αφού κάνουμε
χρονοκαθυστέρηση $50 msec$ για να σταθεροποιηθεί στην τιμή 1 το bit 6 της μάσκας
διακοπών (που δείχνει αν έχει ενεργοποιηθεί ή όχι μια διακοπή), στη συνέχεια
αφού ελέγξουμε ότι το bit 6 της μάσκας έγινε μηδέν (δηλαδή φύγαμε από το
μέτωπο του παλμού διακοπής), υλοποιούμε άλλη μία χρονοκαθυστέρηση $50 msec$ για
να σταθεροποιηθεί στο μηδέν το bit 6, αυξάνουμε το μετρητή των διακοπών κατά
1, ενεργοποιούμε ξανά τις διακοπές και στη συνέχεια επιστρέφουμε στο κύριο
πρόγραμμα που συνεχίζει να τρέχει κανονικά το χρονόμετρο.

Να σημειώσουμε ότι πριν καλέσουμε τη ρουτίνα \textbf{DELB} είναι καλό να
απενεργοποιούμε τις διακοπές γιατί εκτός του ότι μπορεί να υλοποιηθεί
μεγαλύτερη χρονοκαθυστέρηση από την επιθυμητή σε περίπτωση επιπλέον διακοπής,
υπάρχει κίνδυνος να αλλοιωθούν οι καταχωρητές του συστήματος.
\inputminted[linenos,obeytabs,fontsize=\footnotesize]{oldasm}{../askhsh_2_ii_a.8085}
\subsection*{Άσκηση 2(ii) β}
Εδώ το κύριο πρόγραμμα είναι όπως στο ερώτημα α, με τη διαφορά ότι θέλουμε στα
MSB των led να απεικονίζεται ο αριθμός των διακοπτών (dip switches) που είναι
ON. Αυτό το ελέγχουμε με διαδοχικές ολισθήσεις της τιμής που διαβάζουμε από
την είσοδο και έλεγχο της σημαίας κρατουμένου. Έχουμε υλοποιήσει
χρονοκαθυστέρηση $1sec$ για να απεικονίζονται στην έξοδο τα τέσσερα MSB της
εξόδου όταν γίνεται διακοπή. 
\inputminted[linenos,obeytabs,fontsize=\footnotesize]{oldasm}{../askhsh_2_ii_b.8085}

\end{document}
