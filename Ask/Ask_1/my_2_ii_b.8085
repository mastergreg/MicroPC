START:
	MVI A,00H
	MVI E,00H

CHECK_DIP_SWITCH:
	LDA 2000H
	RAL
	CC ACCEPT_INTRP
	JMP COUNT_PROGRAM
	NOP

ACCEPT_INTRP:
	MVI A,0DH ;DEXOMAI MONO THN 6.5 
	SIM
	EI
	RET
	NOP

COUNT_PROGRAM: ;D O METRHTHS TWN 4 LSB
	LXI B,0064H
LOOPD: 
	CALL OUT_TO_LEDS
	DI
	CAll DELB
	MOV A,D
	INR A
	ANI 0FH ;GIA NA MHN EPHREAZONTAI TA MSB OTAN YPARXEI YPERXEILISH STA LSB
	MOV D,A
	JMP CHECK_DIP_SWITCH ;GIA NA TSEKAREI TA MSB AP THN ARXH
	NOP
;ARX_KATHYSTERHSH_KAI_DIS_INTRPS:
;	LXI B,0032H
;	CALL DELB
;	DI 

INTR_ROUTINE: ;=========EDW ARXIZEI H EKSYPHRETHSH DIAKOPHS===========
	PUSH PSW
	PUSH B
	PUSH D
	PUSH H
	NOP
	CALL BEEP
	POP H
	POP D
	POP B
	POP PSW
	NOP
CHECK_ALL_SWITCHES:  ;E O METRHTHS TWN SWITHES, DHLADH TWN 4 MSB	
	LDA 2000H
	MVI E,00H
	RAL
	CC INCR_E
	RAL
	CC INCR_E
	RAL
	CC INCR_E
	RAL
	CC INCR_E
	RAL
	CC INCR_E
	RAL
	CC INCR_E
	RAL
	CC INCR_E
	RAL
	CC INCR_E
	NOP
	LXI B,0032H 
	CALL OUT_TO_LEDS
	CALL DELB ; GIA NA PROLAVOUME NA TA DOUME
	NOP
	
EGKYRH_DIAKOPH_LOOP:
	RIM
	RAL
	RAL
	RAL
	JC EGKYRH_DIAKOPH_LOOP
	NOP	

TEL_KATHYSTERHSH_KAI_ENABL_INTRPS:
	DI
	CALL DELB ; GIA NA STA8EROPOIH8EI SIGOURA TO 0 KAI NA VGOUME
	EI ; ENABLE INTRPS
	NOP
	
	RET ; =============EDW TELEIWNEI H INTR_ROUTINE==============

OUT_TO_LEDS:
	MOV A,E
	CC MHDENISMOS_KRATOUMENOU
	RAL
	RAL
	RAL ;GIA NA PANE STA MSB
	RAL
	NOP
	ADD D ;GT DE VOLEVEI NA GINONTAI TA RAL ALLOU, MPERDEUETAI OTAN 8EOLYME NA AUXHSOUME KATA 1
	CMA ; EPEIDH EXOUN ARN.LOGIKH
	STA 3000H
	RET
	NOP

MHDENISMOS_KRATOUMENOU:
	CMC
	RET

INCR_E:
	INR E
	RET
END

