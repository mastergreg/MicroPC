START:
    IN 10H

READ_BINARY:
    LDA 2000H
    RAL
    JC NEGATIVE
    JNC POSITIVE

;ARNHTIKOS EINAI MONO OTAN MSB==1 , OPOTE KAI TON "METATREPW"

NEGATIVE:
    RAR        ;GIA UNDO THN RAL
    CMA        ;TO SUMPLHRWMA WS PROS 2 TOY SUMPLHRWMATOS WS PROS 2 MAS DINEI TON ARX ARI8MO
    INR A
    MVI E,1CH  ;O E EXEI TO PROSHMO. 17 GIATI AYTO ANTISTOIXEI SE - STHN DCD
    ;CMA        ;TO CMA XREIAZETAI GIATI PLEON OLOI ARITHMOI MOU EINAI 8ETIKOI
    JMP DEC_CONVERTION

POSITIVE:
    RAR        ;GIA UNDO RAL    
    MVI E,10H  ;O E EXEI TO PROSHMO , TO 10 GIATI AUTO ANTISTOIXEI SE KENO STHN DCD

DEC_CONVERTION:

    MVI C,00H  ;STON C OI MONADES
    MVI B,FFH  ;STON B OI DECADES , EBALA FF GIATI META KSEKINAW KANONTAS INR
    MVI D,00H  ;STON D OI EKATONTADES

BCD_FINDER:
    CPI 64H       ;SUGKRINW ME TO 100
    JC ELEGX_DEC ;AN EINAI DHL. NUMBER<100 H' ALLIWS (A)-100<0 TOTE ELEGXEI DECADES
    MVI D,01H   ;ALLIWS O ARITHMOS MAS EXEI MIA EKATONTADA
    SUI 64H ;AFAIRW TO 100 KAI SUNEXIZW GIA DECADES

ELEGX_DEC:
    INR B       
    SUI 0AH ;AFAIRW 10 KAI METRAW POSES DECADES AFAIRESA
    JNC ELEGX_DEC ;MEXRI NA MEINOUNE MONADES
    ADI 0AH ;DIORTHWSH YPOLOIPOU, PROSTHETW 10
    MOV C,A ;STON C OI MONADES  

EMFANISH_STA_3DEKSIA_7SEGM:
    
    ;===1o LSB PSHFIO===
    LXI H,0990H ;BAZW STON H::=C =LEAST SIGN BIT, TIS MONADES @ THESH MNHMHS 0990
    MOV M,C 
    
    ;===2o LSB PSHFIO===
    LXI H,0991H ;BAZW STON H::=B =2o LSB TIS DEKADES @ THESH MNHMHS 0991
    MOV M,B
    
    ;===3o LSB PSHFIO===
    LXI H,0992H ;BAZW STON H::=L THN EKANTONTADA (AN YPARXEI) @ THESH MNHMHS 0991
    MOV M,D
    
    ;===4o LSB PSHFIO===
    LXI H,0993H ;BAZW STON H::=E TO PROSHMO
    MOV M,E
    
    ;===5o lSB PSHFIO===
    LXI H,0994H ;EMFANIZEI KENA TA YPOLOIPA BITS
    MVI M,10H
    
    ;===6o (MSB)PSHFIO===
    LXI H,0995H
    MVI M,10H


    LXI D,0990H ; BAZW STON D THN THESH APO OPOU ARXIZEI TO LSB
    CALL STDM   ; TA METAFEREI TA BITS NA TA PAREI H DCD KAI NA TA PAEI STA 7SEG
    CALL DCD
    JMP START ; H DCD PAIRNEI TA PSHFIA KAI TA BAZEI STOUS 7SEGMENTS
END
